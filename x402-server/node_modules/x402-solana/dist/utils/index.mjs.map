{"version":3,"sources":["../../src/utils/helpers.ts"],"names":[],"mappings":";AAWO,SAAS,kCAAA,CACd,WAAA,EACA,mBAAA,EACA,WAAA,EACQ;AAER,EAAA,MAAM,qBAAA,GAAwB,OAAO,IAAA,CAAK,WAAA,CAAY,WAAW,CAAA,CAAE,SAAS,QAAQ,CAAA;AAGpF,EAAA,MAAM,cAAA,GAAiB;AAAA,IACrB,WAAA;AAAA,IACA,QAAQ,mBAAA,CAAoB,MAAA;AAAA,IAC5B,SAAS,mBAAA,CAAoB,OAAA;AAAA,IAC7B,OAAA,EAAS;AAAA,MACP,WAAA,EAAa;AAAA;AACf,GACF;AAGA,EAAA,MAAM,aAAA,GAAgB,OAAO,IAAA,CAAK,IAAA,CAAK,UAAU,cAAc,CAAC,CAAA,CAAE,QAAA,CAAS,QAAQ,CAAA;AAEnF,EAAA,OAAO,aAAA;AACT;AAOO,SAAS,iBAAiB,OAAA,EAAgC;AAC/D,EAAA,IAAI,YAAY,QAAA,EAAU;AACxB,IAAA,OAAO,qCAAA;AAAA,EACT,CAAA,MAAA,IAAW,YAAY,eAAA,EAAiB;AACtC,IAAA,OAAO,+BAAA;AAAA,EACT;AAEA,EAAA,MAAM,IAAI,KAAA,CAAM,CAAA,oBAAA,EAAuB,OAAO,CAAA,CAAE,CAAA;AAClD;AAMO,SAAS,qBAAqB,OAAA,EAAiD;AACpF,EAAA,IAAI,YAAY,QAAA,EAAU;AACxB,IAAA,OAAO;AAAA,MACL,OAAA,EAAS,8CAAA;AAAA,MACT,QAAA,EAAU;AAAA,KACZ;AAAA,EACF,CAAA,MAAA,IAAW,YAAY,eAAA,EAAiB;AACtC,IAAA,OAAO;AAAA,MACL,OAAA,EAAS,8CAAA;AAAA,MACT,QAAA,EAAU;AAAA,KACZ;AAAA,EACF;AAEA,EAAA,MAAM,IAAI,KAAA,CAAM,CAAA,oBAAA,EAAuB,OAAO,CAAA,CAAE,CAAA;AAClD;AAOO,SAAS,aAAA,CAAc,QAAgB,QAAA,EAA0B;AACtE,EAAA,OAAO,MAAA,CAAO,KAAK,KAAA,CAAM,MAAA,GAAS,KAAK,GAAA,CAAI,EAAA,EAAI,QAAQ,CAAC,CAAC,CAAA;AAC3D;AAOO,SAAS,eAAA,CAAgB,aAA8B,QAAA,EAA0B;AACtF,EAAA,OAAO,OAAO,WAAW,CAAA,GAAI,IAAA,CAAK,GAAA,CAAI,IAAI,QAAQ,CAAA;AACpD;AAIO,SAAS,eAAe,SAAA,EAA2B;AACxD,EAAA,OAAO,IAAA,CAAK,KAAA,CAAM,SAAA,GAAY,GAAS,CAAA;AACzC;AAGO,SAAS,eAAe,SAAA,EAA2B;AACxD,EAAA,OAAO,SAAA,GAAY,GAAA;AACrB","file":"index.mjs","sourcesContent":["import { VersionedTransaction } from \"@solana/web3.js\";\nimport { PaymentRequirements, SolanaNetwork, SPLTokenAmount } from \"../types\";\n\n/**\n * Helper utilities for x402 payment processing\n */\n\n/**\n * Create payment header from a signed transaction\n * Encodes transaction and payment details into base64 X-PAYMENT header\n */\nexport function createPaymentHeaderFromTransaction(\n  transaction: VersionedTransaction,\n  paymentRequirements: PaymentRequirements,\n  x402Version: number\n): string {\n  // Serialize the signed transaction\n  const serializedTransaction = Buffer.from(transaction.serialize()).toString(\"base64\");\n\n  // Create payment payload matching x402 spec\n  const paymentPayload = {\n    x402Version: x402Version,\n    scheme: paymentRequirements.scheme,\n    network: paymentRequirements.network,\n    payload: {\n      transaction: serializedTransaction,\n    },\n  };\n\n  // Encode payment payload as base64 for X-PAYMENT header\n  const paymentHeader = Buffer.from(JSON.stringify(paymentPayload)).toString(\"base64\");\n\n  return paymentHeader;\n}\n\n/**\n * Get default RPC URL for a given Solana network\n * @param network - Must be 'solana' or 'solana-devnet'\n * @returns Default RPC URL for the network\n */\nexport function getDefaultRpcUrl(network: SolanaNetwork): string {\n  if (network === \"solana\") {\n    return \"https://api.mainnet-beta.solana.com\";\n  } else if (network === \"solana-devnet\") {\n    return \"https://api.devnet.solana.com\";\n  }\n  // TypeScript ensures network is one of the two options, so this is unreachable\n  throw new Error(`Unexpected network: ${network}`);\n}\n\n/**\n * Get default SPL token asset for a given Solana network\n * Defaults to USDC, returns x402-compatible SPLTokenAmount['asset']\n */\nexport function getDefaultTokenAsset(network: SolanaNetwork): SPLTokenAmount['asset'] {\n  if (network === \"solana\") {\n    return {\n      address: \"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v\",\n      decimals: 6,\n    };\n  } else if (network === \"solana-devnet\") {\n    return {\n      address: \"4zMMC9srt5Ri5X14GAgXhaHii3GnPAEERYPJgZJDncDU\",\n      decimals: 6,\n    };\n  }\n  // TypeScript ensures network is one of the two options, so this is unreachable\n  throw new Error(`Unexpected network: ${network}`);\n}\n\n/**\n * Convert human-readable amount to token's smallest unit (atomic units)\n * @param amount - Human-readable amount (e.g., 2.5 for 2.5 USDC)\n * @param decimals - Token decimals (e.g., 6 for USDC, 9 for SOL)\n */\nexport function toAtomicUnits(amount: number, decimals: number): bigint {\n  return BigInt(Math.floor(amount * Math.pow(10, decimals)));\n}\n\n/**\n * Convert token's atomic units to human-readable amount\n * @param atomicUnits - Token amount in smallest units\n * @param decimals - Token decimals (e.g., 6 for USDC, 9 for SOL)\n */\nexport function fromAtomicUnits(atomicUnits: bigint | number, decimals: number): number {\n  return Number(atomicUnits) / Math.pow(10, decimals);\n}\n\n// Legacy USDC-specific helpers (deprecated, use toAtomicUnits/fromAtomicUnits instead)\n/** @deprecated Use toAtomicUnits(amount, 6) instead */\nexport function usdToMicroUsdc(usdAmount: number): number {\n  return Math.floor(usdAmount * 1_000_000);\n}\n\n/** @deprecated Use fromAtomicUnits(microUsdc, 6) instead */\nexport function microUsdcToUsd(microUsdc: number): number {\n  return microUsdc / 1_000_000;\n}\n\n"]}